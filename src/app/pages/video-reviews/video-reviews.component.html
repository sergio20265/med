<app-breadcumb [title]="'–í–∏–¥–µ–æ –æ—Ç–∑—ã–≤—ã'"></app-breadcumb>

<div class="video-reviews-container">
  <div class="container">
    <h1 class="page-title">–í–∏–¥–µ–æ –æ—Ç–∑—ã–≤—ã</h1>

    <!-- –°–æ—Å—Ç–æ—è–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏ -->
    <div *ngIf="loading" class="loading-state">
      <div class="loading-spinner"></div>
      <p>–ó–∞–≥—Ä—É–∂–∞–µ–º –≤–∏–¥–µ–æ –æ—Ç–∑—ã–≤—ã...</p>
    </div>

    <!-- –ü—É—Å—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ -->
    <div *ngIf="!loading && videos.length === 0" class="empty-state">
      <div class="empty-icon">üìπ</div>
      <h3>–ü–æ–∫–∞ –Ω–µ—Ç –≤–∏–¥–µ–æ –æ—Ç–∑—ã–≤–æ–≤</h3>
      <p>–°–∫–æ—Ä–æ –∑–¥–µ—Å—å –ø–æ—è–≤—è—Ç—Å—è –æ—Ç–∑—ã–≤—ã –Ω–∞—à–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤</p>
    </div>

    <!-- –ö–∞—Ä—É—Å–µ–ª—å —Å –≤–∏–¥–µ–æ -->
    <div *ngIf="!loading && videos.length > 0" class="video-carousel">
      <div class="carousel-container">
        <!-- –ö–Ω–æ–ø–∫–∞ –Ω–∞–∑–∞–¥ -->
        <button
          class="carousel-btn carousel-btn-prev"
          [class.disabled]="!canScrollLeft"
          (click)="prevSlide()"
          [disabled]="!canScrollLeft"
          aria-label="–ü—Ä–µ–¥—ã–¥—É—â–µ–µ –≤–∏–¥–µ–æ">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
            <path d="M15 18L9 12L15 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>

        <!-- –°–ª–∞–π–¥—ã -->
        <div class="carousel-track-container">
          <div
            class="carousel-track"
            [style.transform]="'translateX(-' + (currentSlide * (100 / slidesPerView)) + '%)'">
            <div
              *ngFor="let video of videos; let i = index; trackBy: trackByVideo"
              class="carousel-slide"
              [style.flex]="'0 0 ' + (100 / slidesPerView) + '%'">
              <!-- –ö–∞—Ä—Ç–æ—á–∫–∞ ‚Äî –∫–ª–∏–∫ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –ø–æ–ø–∞–ø -->
              <div class="video-card" (click)="openModal(video)" role="button" tabindex="0"
                   (keydown.enter)="openModal(video)" aria-label="–°–º–æ—Ç—Ä–µ—Ç—å –æ—Ç–∑—ã–≤">
                <div class="video-wrapper">
                  <!-- –ü—Ä–µ–≤—å—é –±–µ–∑ controls -->
                  <video
                    [src]="getVideoUrl(video)"
                    preload="metadata"
                    muted
                    playsinline
                    class="video-element"
                    [attr.aria-label]="'–í–∏–¥–µ–æ –æ—Ç–∑—ã–≤ ' + (i + 1)">
                  </video>
                  <!-- –ö–Ω–æ–ø–∫–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è -->
                  <div class="play-button-overlay">
                    <div class="play-button">
                      <svg width="32" height="32" viewBox="0 0 24 24" fill="none">
                        <path d="M8 5V19L19 12L8 5Z" fill="currentColor"/>
                      </svg>
                    </div>
                  </div>
                </div>
                <div class="video-info">
                  <h3 class="video-title">–û—Ç–∑—ã–≤ –∫–ª–∏–µ–Ω—Ç–∞</h3>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- –ö–Ω–æ–ø–∫–∞ –≤–ø–µ—Ä–µ–¥ -->
        <button
          class="carousel-btn carousel-btn-next"
          [class.disabled]="!canScrollRight"
          (click)="nextSlide()"
          [disabled]="!canScrollRight"
          aria-label="–°–ª–µ–¥—É—é—â–µ–µ –≤–∏–¥–µ–æ">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
            <path d="M9 18L15 12L9 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>
      </div>

      <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã -->
      <div class="carousel-indicators" *ngIf="videos.length > slidesPerView">
        <button
          *ngFor="let video of videos; let i = index"
          class="indicator"
          [class.active]="i >= currentSlide && i < currentSlide + slidesPerView"
          (click)="goToSlide(i)"
          [attr.aria-label]="'–ü–µ—Ä–µ–π—Ç–∏ –∫ –≤–∏–¥–µ–æ ' + (i + 1)">
        </button>
      </div>
    </div>
  </div>
</div>

<!-- –í–∏–¥–µ–æ –ø–æ–ø–∞–ø -->
<div *ngIf="selectedVideo" class="vr-modal-overlay" (click)="onOverlayClick($event)">
  <div class="vr-modal">
    <button class="vr-modal-close" (click)="closeModal()" aria-label="–ó–∞–∫—Ä—ã—Ç—å">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
        <path d="M18 6L6 18M6 6L18 18" stroke="white" stroke-width="2.5" stroke-linecap="round"/>
      </svg>
    </button>
    <video
      #modalVideo
      [src]="getVideoUrl(selectedVideo)"
      controls
      autoplay
      playsinline
      class="vr-modal-video">
    </video>
  </div>
</div>
